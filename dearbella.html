<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Drag & Heart Game</title>
<link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
<style>
body {
  background-color: #b7ddf2;
  font-family: 'Bangers', cursive;
  text-align: center;
}

h1 {
  color: #2c3e50;
  font-size: 2.5rem;
  margin-top: 20px;
}

#gameBoard {
  display: grid;
  grid-template-columns: repeat(6, 100px);
  gap: 15px;
  justify-content: center;
  margin-top: 20px;
}

.card {
  width: 100px;
  height: 100px;
  perspective: 800px;
  cursor: pointer;
}

.card-inner {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

.card.flipped .card-inner {
  transform: rotateY(180deg);
}

.card-front, .card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 10px;
  backface-visibility: hidden;
}

.card-front {
  background-color: #ffb6c1; /* арын өнгө */
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 2rem;
  color: white;
}

.card-back img {
  width: 100%;
  height: 100%;
  border-radius: 10px;
}
.card.matched .card-back {
  box-shadow: 0 0 20px #ff4f81;
}

#heartCanvas {
  position: fixed;
  top:0;
  left:0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 0;
  opacity: 0.7;
}
</style>
</head>
<body>

<h1>Match the Pictures!</h1>
<canvas id="heartCanvas"></canvas>
<div id="gameBoard"></div>

<audio id="heartSound">
  <source src="heart.mp3" type="audio/mpeg">
</audio>

<script>
// ===== Heart Canvas =====
const canvas = document.getElementById("heartCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let heartsCanvasImages = [];
for(let i=1;i<=18;i++){
  const img = new Image();
  img.src = `images/heart${i}.png`;
  heartsCanvasImages.push(img);
}

function createHearts() {
  hearts = [];
  for(let i=0;i<18;i++){
    hearts.push({
      x: Math.random()*canvas.width,
      y: Math.random()*-canvas.height,
      size: Math.random()*40+30,
      speed: Math.random()*2+1,
      sway: Math.random()*2+1,
      angle: Math.random()*Math.PI*2,
      img: heartsCanvasImages[i],
      opacity: Math.random()
    });
  }
}

function drawHeart(x,y,size,opacity,img){
  if(!img) return;
  ctx.save();
  ctx.globalAlpha = opacity;
  ctx.drawImage(img,x-size/2,y-size/2,size,size);
  ctx.restore();
}

function animateHearts(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  hearts.forEach(h=>{
    h.angle += 0.05;
    h.x += Math.sin(h.angle)*h.sway;
    h.y += h.speed;
    drawHeart(h.x,h.y,h.size,h.opacity,h.img);
    if(h.y>canvas.height+50) h.y=-50;
  });
  requestAnimationFrame(animateHearts);
}

createHearts();
animateHearts();

// ===== Game Board =====
const gameBoard = document.getElementById("gameBoard");
const heartSound = document.getElementById("heartSound");

const heartImages = [];
for(let i=1;i<=18;i++){
  const img = new Image();
  img.src = `images/heart${i}.png`;
  heartImages.push(img);
}

let cardsArray = [...heartImages, ...heartImages];
shuffle(cardsArray);

let firstCard = null;
let secondCard = null;
let lockBoard = false;

cardsArray.forEach(img=>{
  const card = document.createElement("div");
  card.classList.add("card");

  const inner = document.createElement("div");
  inner.classList.add("card-inner");

  const front = document.createElement("div");
  front.classList.add("card-front");
  front.textContent = "?";

  const back = document.createElement("div");
  back.classList.add("card-back");
  const image = document.createElement("img");
  image.src = img.src;
  back.appendChild(image);

  inner.appendChild(front);
  inner.appendChild(back);
  card.appendChild(inner);
  gameBoard.appendChild(card);

  card.addEventListener("click", ()=>{
    if(lockBoard) return;
    if(card===firstCard) return;

    heartSound.currentTime = 0;
    heartSound.play();

    card.classList.add("flipped");

    if(!firstCard){
      firstCard = card;
    } else {
      secondCard = card;
      lockBoard = true;

      const firstImg = firstCard.querySelector(".card-back img").src;
      const secondImg = secondCard.querySelector(".card-back img").src;

      if(firstImg === secondImg){
        firstCard.classList.add("matched");
        secondCard.classList.add("matched");
        resetBoard();
      } else {
        setTimeout(()=>{
          firstCard.classList.remove("flipped");
          secondCard.classList.remove("flipped");
          resetBoard();
        },800);
      }
    }
  });
});

function resetBoard(){
  [firstCard, secondCard, lockBoard] = [null, null, false];
}

function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}
</script>
</body>
</html>

